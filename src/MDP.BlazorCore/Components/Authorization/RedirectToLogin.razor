
@namespace MDP.BlazorCore
@code {

    // Fields
    [Inject]
    public RoutesOptions _routesOptions { get; set; }

    [Inject]
    public NavigationManager _navigationManager { get; set; }


    // Methods
    protected override Task OnInitializedAsync()
    {
        // LoginPath
        var loginPath = _routesOptions.LoginPath;
        if (string.IsNullOrEmpty(loginPath) == true) loginPath = "/";

        // ReturnUrl
        var returnUrl = string.Empty;
        if (string.IsNullOrEmpty(returnUrl) == true) returnUrl = (new Uri(_navigationManager.Uri)).PathAndQuery;
        if (string.IsNullOrEmpty(returnUrl) == true) returnUrl = "/";
        returnUrl = Uri.EscapeDataString(returnUrl);

        // Redirect
        _navigationManager.NavigateTo($"{loginPath}?returnUrl={returnUrl}");

        // Return
        return Task.CompletedTask;
    }
}